/* Question 1 */WITH first_touch AS (SELECT user_id,MIN(timestamp) as first_touch_atFROM page_visitsGROUP BY user_id)SELECT ft.user_id, ft.first_touch_at, pv.utm_source, pv.utm_campaignFROM first_touch ftJOIN page_visits pvON ft.user_id = pv.user_idAND ft.first_touch_at = pv.timestamp;SELECT COUNT(DISTINCT utm_campaign) AS campaigns_count FROM page_visits;SELECT COUNT(DISTINCT utm_source) AS source_countFROM page_visits;SELECT DISTINCT utm_campaign, utm_source AS campaign_source FROM page_visits;/* Question 2 */SELECT DISTINCT page_nameFROM page_visits;/* Question 3 */WITH first_touch AS (SELECT user_id,MIN(timestamp) as first_touch_atFROM page_visitsGROUP BY user_id)SELECT pv.utm_campaign, pv.utm_source, COUNT(*) AS num_first_touchFROM	first_touch ftJOIN page_visits pvON ft.user_id = pv.user_idAND ft.first_touch_at = pv.timestampGROUP BY pv.utm_campaign, pv.utm_sourceORDER BY 3;/* Question 4 */WITH last_touch AS (SELECT user_id,MAX(timestamp) as last_touch_atFROM page_visitsGROUP BY user_id)SELECT pv.utm_source, pv.utm_campaign, COUNT(*) AS num_last_touchFROM last_touch ltJOIN page_visits pvON lt.user_id = pv.user_idAND lt.last_touch_at = pv.timestampGROUP BY pv.utm_source, pv.utm_campaignORDER BY 3; /* Question 5 */SELECT COUNT(DISTINCT user_id) AS num_user_purchaseFROM page_visitsWHERE page_name = '4 - purchase';/* Quesiton 6 */WITH last_touch AS (SELECT user_id,MAX(timestamp) as last_touch_atFROM page_visitsGROUP BY user_id)SELECT pv.utm_source, pv.utm_campaign, COUNT(*) AS num_last_touch_on_purchaseFROM last_touch ltJOIN page_visits pvON lt.user_id = pv.user_idAND lt.last_touch_at = pv.timestampWHERE page_name = '4 - purchase'GROUP BY pv.utm_source, pv.utm_campaignORDER BY 3;